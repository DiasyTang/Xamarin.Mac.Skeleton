// This file has been autogenerated from a class added in the UI designer.

using System;

using Foundation;
using AppKit;
using Skeleton.Mac.FilesTableView;
using ObjCRuntime;
using CoreGraphics;

namespace Skeleton.Mac
{
	public partial class FileTableView : NSTableView
	{
        private int Row = -1;
		public FileTableView (IntPtr handle) : base (handle)
		{
            
		}

		public override void WillOpenMenu(NSMenu menu, NSEvent theEvent)
		{
            base.WillOpenMenu(menu, theEvent);
            if (Row < 0)
            {
                menu.CancelTracking();
            }
		}

		public override void AwakeFromNib()
		{
            base.AwakeFromNib();
            var filemenu = new NSMenu();
            filemenu.AddItem(new NSMenuItem("Export", ExportMenu));

            this.Menu = filemenu;
            this.DoubleClick += FileTableViewDoubleCliked;
		}

        private void FileTableViewDoubleCliked(object sender,EventArgs args){
            
        }

        private void ExportMenu(object sender, EventArgs args)
        {

        }

		public override void SelectRows(NSIndexSet indexes, bool byExtendingSelection)
		{
            base.SelectRows(indexes, byExtendingSelection);
		}

		public override NSView HitTest(CGPoint aPoint)
		{
            Row = (int)GetRow(aPoint);
            return base.HitTest(aPoint);
		}

        public delegate void ClickedDelegate(FileItem item);
        public event ClickedDelegate Clicked;

        internal void RaiseClickedEvent(FileItem item){
            this.Clicked?.Invoke(item);
        }
	}
}
